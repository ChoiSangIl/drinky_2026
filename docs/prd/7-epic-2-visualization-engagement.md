# 7. Epic 2: Visualization & Engagement

## Epic Goal

음주 기록 차트, 푸시 알림, 설정 기능을 추가하여 **사용자 리텐션을 높이고 MVP를 완성**합니다. 이 에픽 완료 시 사용자는 자신의 음주 패턴을 시각적으로 확인하고, 푸시 알림으로 동기부여를 받으며, 앱을 자신에게 맞게 설정할 수 있습니다.

## Story 2.1: 기록 차트 - 캘린더 뷰

**As a** 사용자,
**I want** 월간 캘린더에서 내 음주 기록을 한눈에 볼 수 있어서,
**so that** 어떤 날에 술을 마셨는지 패턴을 파악할 수 있다.

**Acceptance Criteria:**
1. 기록 탭/페이지 생성 및 네비게이션 연결
2. 월간 캘린더 뷰 구현 (현재 월 기본 표시)
3. 각 날짜에 O/X 아이콘 또는 색상으로 음주 여부 표시
4. 이전/다음 월 네비게이션
5. 기록 없는 날은 빈 상태로 표시
6. 특정 날짜 클릭 시 해당 날짜 상세 정보 표시 (모달 또는 바텀시트)
7. 모바일 반응형 UI

## Story 2.2: 기록 차트 - 통계 및 인사이트

**As a** 사용자,
**I want** 주간/월간 음주 통계를 그래프로 확인할 수 있어서,
**so that** 내 음주 습관의 추세를 이해하고 개선할 수 있다.

**Acceptance Criteria:**
1. 주간 음주 횟수 바 차트 (최근 4주)
2. 월간 음주 횟수 추이 그래프 (최근 3개월)
3. 핵심 통계 카드 표시:
   - 이번 주 음주 횟수 / 지난 주 대비
   - 이번 달 음주 횟수 / 지난 달 대비
   - 현재 스트릭 / 최장 스트릭
4. 긍정적 인사이트 메시지 ("지난 주보다 2일 줄었어요!")
5. 차트 라이브러리 사용 (Recharts 또는 Chart.js)
6. 데이터 없는 기간 처리 (빈 상태 메시지)

## Story 2.3: 과거 기록 조회 및 수정

**As a** 사용자,
**I want** 최근 7일 이내의 기록을 수정할 수 있어서,
**so that** 깜빡하고 기록하지 못한 날을 보완할 수 있다.

**Acceptance Criteria:**
1. 캘린더 뷰에서 날짜 클릭 시 기록 상세 표시
2. 7일 이내 날짜는 수정 버튼 활성화
3. 7일 초과 날짜는 수정 버튼 비활성화 + 안내 메시지
4. 기록 수정 시 확인 다이얼로그 표시
5. 기록 없는 과거 날짜에 새 기록 추가 가능 (7일 이내)
6. 수정 완료 시 스트릭 자동 재계산
7. 수정 이력 로깅 (데이터 무결성용)

## Story 2.4: 푸시 알림 인프라 구축

**As a** 사용자,
**I want** 앱에서 푸시 알림을 받을 수 있어서,
**so that** 앱을 열지 않아도 절주 동기부여를 받을 수 있다.

**Acceptance Criteria:**
1. Firebase Cloud Messaging (FCM) 프로젝트 설정
2. PWA Service Worker에 푸시 알림 수신 로직 추가
3. 사용자에게 알림 권한 요청 UI 구현
4. 알림 권한 수락 시 FCM 토큰 저장 (Supabase)
5. 알림 권한 거부 시 안내 메시지 및 나중에 다시 묻기
6. 테스트 알림 발송 및 수신 확인
7. 알림 클릭 시 앱으로 이동

## Story 2.5: 푸시 알림 스케줄링 및 콘텐츠

**As a** 사용자,
**I want** 매일 설정한 시간에 격려 알림을 받을 수 있어서,
**so that** 잊지 않고 체크인하고 동기부여를 유지할 수 있다.

**Acceptance Criteria:**
1. 알림 스케줄링 백엔드 로직 (Supabase Edge Function 또는 외부 서비스)
2. 기본 알림 시간 설정 (저녁 9시)
3. 격려 메시지 템플릿 (최소 10종):
   - "오늘 하루도 고생했어요! 체크인 해볼까요?"
   - "🔥 {N}일 연속 성공 중! 오늘도 화이팅!"
   - "건강한 선택이 쌓이고 있어요 💪"
4. 스트릭 기반 메시지 분기 (스트릭 0일 vs 7일+)
5. 오늘 이미 체크인한 경우 다른 메시지 ("오늘도 기록 완료! 대단해요")
6. 알림 발송 로그 저장

## Story 2.6: 설정 화면

**As a** 사용자,
**I want** 알림 시간과 계정 정보를 관리할 수 있어서,
**so that** 앱을 나에게 맞게 커스터마이징할 수 있다.

**Acceptance Criteria:**
1. 설정 탭/페이지 생성 및 네비게이션 연결
2. 알림 설정 섹션:
   - 푸시 알림 ON/OFF 토글
   - 알림 시간 선택 (시간 피커)
3. 계정 설정 섹션:
   - 닉네임 수정
   - 이메일 표시 (읽기 전용)
   - 로그아웃 버튼
4. 앱 정보 섹션:
   - 버전 정보
   - 개인정보처리방침 링크
   - 문의하기 (이메일 링크)
5. 계정 삭제 기능 (확인 다이얼로그 필수)
6. 설정 변경 시 즉시 저장

## Story 2.7: PWA 최적화 및 MVP 마무리

**As a** 사용자,
**I want** 앱을 홈 화면에 추가하고 오프라인에서도 기본 기능을 사용할 수 있어서,
**so that** 네이티브 앱처럼 편리하게 사용할 수 있다.

**Acceptance Criteria:**
1. Web App Manifest 최적화 (아이콘, 테마 컬러, 시작 URL)
2. "홈 화면에 추가" 프롬프트 구현 (적절한 타이밍)
3. 오프라인 캐싱 전략 구현:
   - 정적 자산 캐싱
   - 최근 기록 데이터 로컬 캐싱
   - 오프라인 시 체크인 → 온라인 복귀 시 동기화
4. 앱 로딩 스플래시 화면
5. Lighthouse PWA 점수 90점 이상
6. 성능 최적화 (첫 로딩 3초 이내)
7. 크로스 브라우저 테스트 (Chrome, Safari, Samsung Internet)

---
