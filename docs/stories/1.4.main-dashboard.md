# Story 1.4: ë©”ì¸ ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ

## Status

**Ready for Review**

---

## Story

**As a** ë¡œê·¸ì¸í•œ ì‚¬ìš©ì,
**I want** ì•± ì§„ì… ì‹œ ì˜¤ëŠ˜ì˜ ìƒíƒœë¥¼ í•œëˆˆì— ë³¼ ìˆ˜ ìˆëŠ” ëŒ€ì‹œë³´ë“œë¥¼ ë³´ê³  ì‹¶ì–´ì„œ,
**so that** ë¹ ë¥´ê²Œ ì˜¤ëŠ˜ì˜ ì²´í¬ì¸ì„ í•  ìˆ˜ ìˆë‹¤.

---

## Acceptance Criteria

1. ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ë ˆì´ì•„ì›ƒ êµ¬í˜„
2. ìƒë‹¨ì— ì¸ì‚¬ ë©”ì‹œì§€ í‘œì‹œ ("ì•ˆë…•í•˜ì„¸ìš”, {ë‹‰ë„¤ì„}ë‹˜!")
3. ì¤‘ì•™ì— ì˜¤ëŠ˜ì˜ ì²´í¬ì¸ ì˜ì—­ (í”Œë ˆì´ìŠ¤í™€ë”)
4. í•˜ë‹¨ì— ìŠ¤íŠ¸ë¦­ í‘œì‹œ ì˜ì—­ (í”Œë ˆì´ìŠ¤í™€ë”)
5. í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” (í™ˆ, ê¸°ë¡, ì„¤ì • - ê¸°ë¡/ì„¤ì •ì€ ë¹„í™œì„±)
6. ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ (ì„¤ì • ë˜ëŠ” ì„ì‹œ ë²„íŠ¼)
7. ëª¨ë°”ì¼ ë°˜ì‘í˜• UI

---

## Tasks / Subtasks

- [x] **Task 1: ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ êµ¬ì¡°** (AC: 1, 7)
  - [x] `templates/layout/app-base.html` ìƒì„± (ì•± ë‚´ë¶€ ë ˆì´ì•„ì›ƒ)
    - [x] ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ + í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ í¬í•¨
  - [x] ëª¨ë°”ì¼ í¼ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒ (safe-area ê³ ë ¤, pb-safe í´ë˜ìŠ¤)
  - [x] ìµœëŒ€ ë„ˆë¹„ ì œí•œ (max-w-md)

- [x] **Task 2: HomeController êµ¬í˜„** (AC: 1)
  - [x] `HomeController.kt` ìˆ˜ì •
  - [x] `GET /` - ë©”ì¸ ëŒ€ì‹œë³´ë“œ ë Œë”ë§
  - [x] `@AuthenticationPrincipal UserPrincipal`ë¡œ ì‚¬ìš©ì ì •ë³´ Modelì— ì¶”ê°€
  - [x] `UserPrincipal`ì— `profileImage` í•„ë“œ ì¶”ê°€

- [x] **Task 3: ì¸ì‚¬ ë©”ì‹œì§€ í—¤ë”** (AC: 2)
  - [x] ìƒë‹¨ì— ì‚¬ìš©ì ë‹‰ë„¤ì„ í‘œì‹œ ("ì•ˆë…•í•˜ì„¸ìš”, {ë‹‰ë„¤ì„}ë‹˜! ğŸ‘‹")
  - [x] í”„ë¡œí•„ ì´ë¯¸ì§€ (ìˆìœ¼ë©´ í‘œì‹œ, ì—†ìœ¼ë©´ ì´ë‹ˆì…œ ì•„ë°”íƒ€)
  - [x] ì‘ì› ë©”ì‹œì§€ ("ì˜¤ëŠ˜ë„ í™”ì´íŒ…!")

- [x] **Task 4: ì²´í¬ì¸ ì˜ì—­ í”Œë ˆì´ìŠ¤í™€ë”** (AC: 3)
  - [x] ì¤‘ì•™ì— ì²´í¬ì¸ ì¹´ë“œ ì˜ì—­ ìƒì„± (bg-white rounded-2xl shadow-sm)
  - [x] "ì˜¤ëŠ˜ì˜ ì²´í¬ì¸" ì œëª© + ì•ˆë‚´ ë©”ì‹œì§€
  - [x] O/X ë²„íŠ¼ í”Œë ˆì´ìŠ¤í™€ë” (disabled ìƒíƒœ)

- [x] **Task 5: ìŠ¤íŠ¸ë¦­ ì˜ì—­ í”Œë ˆì´ìŠ¤í™€ë”** (AC: 4)
  - [x] ìŠ¤íŠ¸ë¦­ í‘œì‹œ ì¹´ë“œ ì˜ì—­ ìƒì„±
  - [x] ìŠ¤íŠ¸ë¦­ ìˆ«ì (0ì¼) + ğŸ”¥ ì•„ì´ì½˜
  - [x] ì£¼ê°„ ë¯¸ë‹ˆ ìº˜ë¦°ë” í”Œë ˆì´ìŠ¤í™€ë” (ì›”~ì¼)

- [x] **Task 6: í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°”** (AC: 5)
  - [x] `templates/fragments/bottom-nav.html` ìƒì„±
  - [x] 3ê°œ íƒ­: í™ˆ(í™œì„±), ê¸°ë¡(ë¹„í™œì„±), ì„¤ì •(ë¹„í™œì„±)
  - [x] SVG ì•„ì´ì½˜ + ë¼ë²¨ êµ¬ì¡°
  - [x] safe-area-inset-bottom ì ìš© (pb-safe)
  - [x] min-w-[64px] min-h-[44px] í„°ì¹˜ íƒ€ê²Ÿ

- [x] **Task 7: ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥** (AC: 6)
  - [x] í—¤ë” ìš°ì¸¡ì— ë¡œê·¸ì•„ì›ƒ ì•„ì´ì½˜ ë²„íŠ¼
  - [x] `/logout` ë§í¬ë¡œ ë¡œê·¸ì•„ì›ƒ
  - [x] SecurityConfigì—ì„œ ë¡œê·¸ì•„ì›ƒ í›„ `/login?logout` ë¦¬ë‹¤ì´ë ‰íŠ¸

- [x] **Task 8: ë°˜ì‘í˜• ë° ìŠ¤íƒ€ì¼ë§** (AC: 7)
  - [x] ëª¨ë°”ì¼ í¼ìŠ¤íŠ¸ (max-w-md, px-4 íŒ¨ë”©)
  - [x] ì¹´ë“œ ê·¸ë¦¼ì (shadow-sm), ë‘¥ê·¼ ëª¨ì„œë¦¬ (rounded-2xl)
  - [x] ìƒ‰ìƒ í…Œë§ˆ (emerald-600, gray-800)
  - [x] í„°ì¹˜ ì˜ì—­ min-h-[44px] ì ìš©

---

## Dev Notes

### í”„ë¡œì íŠ¸ êµ¬ì¡° (ì´ ìŠ¤í† ë¦¬ ê´€ë ¨)

```
src/main/kotlin/com/drinky/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ HomeController.kt
â””â”€â”€ service/
    â””â”€â”€ UserService.kt

src/main/resources/templates/
â”œâ”€â”€ layout/
â”‚   â””â”€â”€ app-base.html
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ home.html
â””â”€â”€ fragments/
    â”œâ”€â”€ header.html
    â”œâ”€â”€ bottom-nav.html
    â”œâ”€â”€ checkin-placeholder.html
    â””â”€â”€ streak-placeholder.html
```

### ëŒ€ì‹œë³´ë“œ í™”ë©´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘‹ ì•ˆë…•í•˜ì„¸ìš”, í™ê¸¸ë™ë‹˜!    â”‚  â† í—¤ë”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    ì˜¤ëŠ˜ì˜ ì²´í¬ì¸       â”‚  â”‚  â† ì²´í¬ì¸ ì¹´ë“œ
â”‚  â”‚    [â­•]    [âŒ]       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ”¥ ì—°ì† 7ì¼!          â”‚  â”‚  â† ìŠ¤íŠ¸ë¦­ ì¹´ë“œ
â”‚  â”‚  [ì›”][í™”][ìˆ˜][ëª©]...   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ğŸ í™ˆ]  [ğŸ“…ê¸°ë¡]  [âš™ì„¤ì •]  â”‚  â† í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### home.html ì˜ˆì‹œ

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/app-base}">
<head>
    <title>í™ˆ</title>
</head>
<body>
<main layout:fragment="content" class="pb-20">
    <!-- í—¤ë” -->
    <header class="px-4 py-6">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500 text-sm">ì˜¤ëŠ˜ë„ í™”ì´íŒ…!</p>
                <h1 class="text-xl font-bold text-gray-800">
                    ì•ˆë…•í•˜ì„¸ìš”, <span th:text="${user.nickname}">ì‚¬ìš©ì</span>ë‹˜! ğŸ‘‹
                </h1>
            </div>
            <img th:src="${user.profileImage ?: '/icons/default-avatar.svg'}"
                 class="w-10 h-10 rounded-full" alt="í”„ë¡œí•„">
        </div>
    </header>

    <!-- ì²´í¬ì¸ ì¹´ë“œ -->
    <section class="px-4 mb-6">
        <div class="bg-white rounded-2xl shadow-sm p-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-4">ì˜¤ëŠ˜ì˜ ì²´í¬ì¸</h2>
            <!-- Story 1.5ì—ì„œ êµ¬í˜„ -->
            <div id="checkin-area" class="flex justify-center gap-6">
                <div class="w-20 h-20 bg-gray-100 rounded-full"></div>
                <div class="w-20 h-20 bg-gray-100 rounded-full"></div>
            </div>
        </div>
    </section>

    <!-- ìŠ¤íŠ¸ë¦­ ì¹´ë“œ -->
    <section class="px-4">
        <div class="bg-white rounded-2xl shadow-sm p-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-4">ë‚˜ì˜ ìŠ¤íŠ¸ë¦­</h2>
            <!-- Story 1.6ì—ì„œ êµ¬í˜„ -->
            <div id="streak-area">
                <p class="text-gray-400">ìŠ¤íŠ¸ë¦­ ì •ë³´ ë¡œë”© ì¤‘...</p>
            </div>
        </div>
    </section>
</main>
</body>
</html>
```

### app-base.html ë ˆì´ì•„ì›ƒ ì˜ˆì‹œ

```html
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <link rel="stylesheet" th:href="@{/css/output.css}">
    <script src="/js/htmx.min.js" defer></script>
    <script src="/js/alpine.min.js" defer></script>
    <title layout:title-pattern="$CONTENT_TITLE - Drinky">Drinky</title>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="max-w-md mx-auto min-h-screen flex flex-col">
        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <main layout:fragment="content" class="flex-1">
        </main>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <th:block th:replace="~{fragments/bottom-nav :: nav}"></th:block>
    </div>
</body>
</html>
```

### bottom-nav.html í”„ë˜ê·¸ë¨¼íŠ¸ ì˜ˆì‹œ

```html
<nav th:fragment="nav"
     class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 pb-safe">
    <div class="max-w-md mx-auto flex justify-around py-2">
        <!-- í™ˆ (í™œì„±) -->
        <a href="/" class="flex flex-col items-center py-2 px-4 text-emerald-600">
            <svg class="w-6 h-6"><!-- í™ˆ ì•„ì´ì½˜ --></svg>
            <span class="text-xs mt-1">í™ˆ</span>
        </a>
        <!-- ê¸°ë¡ (ë¹„í™œì„±) -->
        <span class="flex flex-col items-center py-2 px-4 text-gray-300 cursor-not-allowed">
            <svg class="w-6 h-6"><!-- ìº˜ë¦°ë” ì•„ì´ì½˜ --></svg>
            <span class="text-xs mt-1">ê¸°ë¡</span>
        </span>
        <!-- ì„¤ì • (ë¹„í™œì„±) -->
        <span class="flex flex-col items-center py-2 px-4 text-gray-300 cursor-not-allowed">
            <svg class="w-6 h-6"><!-- ì„¤ì • ì•„ì´ì½˜ --></svg>
            <span class="text-xs mt-1">ì„¤ì •</span>
        </span>
    </div>
</nav>
```

### HomeController ì˜ˆì‹œ

```kotlin
@Controller
class HomeController(
    private val userService: UserService
) {
    @GetMapping("/")
    fun home(@AuthenticationPrincipal principal: UserPrincipal, model: Model): String {
        val user = userService.findById(principal.userId)
        model.addAttribute("user", user)
        return "pages/home"
    }
}
```

---

## Testing

### ì´ ìŠ¤í† ë¦¬ì˜ í…ŒìŠ¤íŠ¸ ìš”êµ¬ì‚¬í•­

| í…ŒìŠ¤íŠ¸ íŒŒì¼ | í…ŒìŠ¤íŠ¸ ë‚´ìš© |
|------------|------------|
| `HomeControllerTest.kt` | ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ë Œë”ë§, ì‚¬ìš©ì ì •ë³´ í‘œì‹œ |

### í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ

```kotlin
@WebMvcTest(HomeController::class)
class HomeControllerTest {

    @Test
    @WithMockUser
    fun `ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ì ‘ê·¼ ì„±ê³µ`() {
        mockMvc.perform(get("/"))
            .andExpect(status().isOk)
            .andExpect(view().name("pages/home"))
            .andExpect(model().attributeExists("user"))
    }

    @Test
    fun `ë¯¸ì¸ì¦ ì‚¬ìš©ìëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸`() {
        mockMvc.perform(get("/"))
            .andExpect(status().is3xxRedirection)
            .andExpect(redirectedUrlPattern("**/login"))
    }
}
```

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-24 | 0.1 | ìŠ¤í† ë¦¬ ì´ˆì•ˆ ì‘ì„± | PO Sarah |
| 2026-02-05 | 0.2 | ì „ì²´ êµ¬í˜„ ì™„ë£Œ (ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ, í•˜ë‹¨ ë„¤ë¹„, ë¡œê·¸ì•„ì›ƒ) | Dev James |

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References
*(ê°œë°œ ì¤‘ ìƒì„±ëœ ë””ë²„ê·¸ ë¡œê·¸ ì°¸ì¡°)*

### Completion Notes List
- **Task 1**: `app-base.html` ì‹ ê·œ ìƒì„±. safe-area CSS ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ë¡œ ì¶”ê°€.
- **Task 2**: `UserPrincipal`ì— `profileImage` í•„ë“œ ì¶”ê°€í•˜ì—¬ í”„ë¡œí•„ ì´ë¯¸ì§€ ì§€ì›.
- **Task 3**: í”„ë¡œí•„ ì´ë¯¸ì§€ ì—†ì„ ì‹œ ë‹‰ë„¤ì„ ì²« ê¸€ìë¥¼ ì´ë‹ˆì…œë¡œ í‘œì‹œí•˜ëŠ” í´ë°± UI êµ¬í˜„.
- **Task 4/5**: ì²´í¬ì¸/ìŠ¤íŠ¸ë¦­ ì¹´ë“œëŠ” í”Œë ˆì´ìŠ¤í™€ë”ë¡œ êµ¬í˜„. Story 1.5, 1.6ì—ì„œ ì‹¤ì œ ê¸°ëŠ¥ êµ¬í˜„ ì˜ˆì •.
- **Task 6**: ê¸°ë¡/ì„¤ì • íƒ­ì€ `cursor-not-allowed`ì™€ íšŒìƒ‰ ì»¬ëŸ¬ë¡œ ë¹„í™œì„±í™” í‘œì‹œ.
- **Task 7**: ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì„ í—¤ë” ìš°ì¸¡ í”„ë¡œí•„ ì˜†ì— ë°°ì¹˜.

### File List
**ì‹ ê·œ ìƒì„±:**
- `src/main/resources/templates/layout/app-base.html` - ì•± ë‚´ë¶€ ë ˆì´ì•„ì›ƒ (í•˜ë‹¨ ë„¤ë¹„ í¬í•¨)
- `src/main/resources/templates/fragments/bottom-nav.html` - í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” í”„ë˜ê·¸ë¨¼íŠ¸

**ìˆ˜ì •:**
- `src/main/resources/templates/pages/home.html` - ëŒ€ì‹œë³´ë“œ UI (í—¤ë”, ì²´í¬ì¸ ì¹´ë“œ, ìŠ¤íŠ¸ë¦­ ì¹´ë“œ)
- `src/main/kotlin/com/drinky/controller/HomeController.kt` - ì‚¬ìš©ì ì •ë³´ Modelì— ì¶”ê°€
- `src/main/kotlin/com/drinky/security/UserPrincipal.kt` - `profileImage` í•„ë“œ ì¶”ê°€

---

## QA Results
*(QA ì—ì´ì „íŠ¸ì˜ ë¦¬ë·° ê²°ê³¼)*
