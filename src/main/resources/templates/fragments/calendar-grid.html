<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="grid" id="calendar-grid">
    <!-- 월 네비게이션 -->
    <div class="flex items-center justify-between mb-4">
        <button th:hx-get="@{/calendar/{year}/{month}(year=${prevYear}, month=${prevMonth})}"
                hx-target="#calendar-grid"
                hx-swap="outerHTML"
                class="p-2 hover:bg-gray-100 rounded-full min-w-[44px] min-h-[44px] flex items-center justify-center">
            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
        </button>
        <h2 class="text-lg font-semibold text-gray-800"
            th:text="${year + '년 ' + month + '월'}">2026년 2월</h2>
        <button th:hx-get="@{/calendar/{year}/{month}(year=${nextYear}, month=${nextMonth})}"
                hx-target="#calendar-grid"
                hx-swap="outerHTML"
                class="p-2 hover:bg-gray-100 rounded-full min-w-[44px] min-h-[44px] flex items-center justify-center">
            <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
        </button>
    </div>

    <!-- 요일 헤더 -->
    <div class="grid grid-cols-7 gap-1 mb-2">
        <div class="text-center text-xs text-red-400 py-2">일</div>
        <div class="text-center text-xs text-gray-400 py-2">월</div>
        <div class="text-center text-xs text-gray-400 py-2">화</div>
        <div class="text-center text-xs text-gray-400 py-2">수</div>
        <div class="text-center text-xs text-gray-400 py-2">목</div>
        <div class="text-center text-xs text-gray-400 py-2">금</div>
        <div class="text-center text-xs text-blue-400 py-2">토</div>
    </div>

    <!-- 캘린더 날짜 -->
    <div class="grid grid-cols-7 gap-1">
        <div th:each="day : ${calendarDays}"
             class="aspect-square flex items-center justify-center">

            <!-- 현재 달, 과거/오늘 (클릭 가능) -->
            <button th:if="${day.isCurrentMonth && !day.isFuture}"
                    onclick="openDayDetail(this)"
                    th:data-date="${day.date}"
                    th:data-sober="${day.isSober}"
                    th:data-note="${day.checkIn?.note}"
                    th:classappend="${day.isToday ? 'ring-2 ring-emerald-400' : ''}"
                    class="w-10 h-10 rounded-full flex items-center justify-center transition-all active:scale-95 touch-manipulation">
                <!-- 금주 -->
                <span th:if="${day.hasRecord && day.isSober}" class="text-lg">⭕</span>
                <!-- 음주 -->
                <span th:if="${day.hasRecord && !day.isSober}" class="text-lg">❌</span>
                <!-- 기록 없음 -->
                <span th:if="${!day.hasRecord}" class="text-sm text-gray-400" th:text="${day.dayOfMonth}">1</span>
            </button>

            <!-- 미래 날짜 -->
            <span th:if="${day.isCurrentMonth && day.isFuture}"
                  class="w-10 h-10 rounded-full flex items-center justify-center text-sm text-gray-200"
                  th:text="${day.dayOfMonth}">1</span>

            <!-- 이전/다음 달 -->
            <span th:if="${!day.isCurrentMonth}"
                  class="w-10 h-10 rounded-full flex items-center justify-center text-sm text-gray-200"
                  th:text="${day.dayOfMonth}">1</span>
        </div>
    </div>
</div>
</html>
